{"expand":"renderedFields,names,schema,transitions,operations,editmeta,changelog","id":"137589","self":"http://jira.codehaus.org/rest/api/latest/issue/137589","key":"PLXUTILS-151","fields":{"progress":{"progress":0,"total":0},"summary":"FileUtils.deleteDirectory() attempts to traverse symlinks, then fails when it encounters a file it can't delete","timetracking":{},"issuetype":{"self":"http://jira.codehaus.org/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"http://jira.codehaus.org/images/icons/issuetypes/bug.png","name":"Bug","subtask":false},"customfield_10110":null,"votes":{"self":"http://jira.codehaus.org/rest/api/2/issue/PLXUTILS-151/votes","votes":0,"hasVoted":false},"resolution":{"self":"http://jira.codehaus.org/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"fixVersions":[{"self":"http://jira.codehaus.org/rest/api/2/version/18570","id":"18570","name":"3.0.2","archived":false,"released":true,"releaseDate":"2012-07-09"}],"resolutiondate":"2012-06-05T17:56:20.682-0500","customfield_10210":"0.0","timespent":null,"reporter":{"self":"http://jira.codehaus.org/rest/api/2/user?username=minfrin","name":"minfrin","emailAddress":"minfrin@sharp.fm","avatarUrls":{"16x16":"http://jira.codehaus.org/secure/useravatar?size=xsmall&avatarId=10232","24x24":"http://jira.codehaus.org/secure/useravatar?size=small&avatarId=10232","32x32":"http://jira.codehaus.org/secure/useravatar?size=medium&avatarId=10232","48x48":"http://jira.codehaus.org/secure/useravatar?avatarId=10232"},"displayName":"Graham Leggett","active":true},"aggregatetimeoriginalestimate":null,"customfield_10161":["minfrin(minfrin)","olamy(olamy)"],"customfield_10160":null,"updated":"2012-06-05T17:57:44.973-0500","created":"2012-06-05T16:39:38.299-0500","description":"When deleteDirectory() walks the tree in an attempt to delete directories, it follows symbolic links. If the symlink points somewhere read only, the attempt to delete fails.\r\n\r\nThis renders it impossible to use symlinks with the rpm-maven-plugin when the symlinks point at the filesystem outside the build in http://jira.codehaus.org/browse/MRPM-115.\r\n\r\nThe fix is to attempt to delete the directory before attempting to delete children, and bypass the children walk if the delete succeeded. This removes symlinks safely without traversing them accidentally.\r\n\r\n{code}\r\nIndex: src/main/java/org/codehaus/plexus/util/FileUtils.java\r\n===================================================================\r\n--- src/main/java/org/codehaus/plexus/util/FileUtils.java\t(revision 8799)\r\n+++ src/main/java/org/codehaus/plexus/util/FileUtils.java\t(working copy)\r\n@@ -1567,6 +1567,14 @@\r\n             return;\r\n         }\r\n \r\n+        /* try delete the directory before its contents, which will take\r\n+         * care of any directories that are really symbolic links.\r\n+         */\r\n+        if ( directory.delete() )\r\n+        {\r\n+        \treturn;\r\n+        }\r\n+\r\n         cleanDirectory( directory );\r\n         if ( !directory.delete() )\r\n         {\r\n{code}\r\n","priority":{"self":"http://jira.codehaus.org/rest/api/2/priority/3","iconUrl":"http://jira.codehaus.org/images/icons/priorities/major.png","name":"Major","id":"3"},"duedate":null,"issuelinks":[],"customfield_10163":"82339200","watches":{"self":"http://jira.codehaus.org/rest/api/2/issue/PLXUTILS-151/watchers","watchCount":2,"isWatching":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"subtasks":[],"status":{"self":"http://jira.codehaus.org/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.","iconUrl":"http://jira.codehaus.org/images/icons/statuses/closed.png","name":"Closed","id":"6"},"customfield_10090":null,"labels":[],"workratio":-1,"assignee":{"self":"http://jira.codehaus.org/rest/api/2/user?username=olamy","name":"olamy","emailAddress":"olamy@apache.org","avatarUrls":{"16x16":"http://jira.codehaus.org/secure/useravatar?size=xsmall&avatarId=10232","24x24":"http://jira.codehaus.org/secure/useravatar?size=small&avatarId=10232","32x32":"http://jira.codehaus.org/secure/useravatar?size=medium&avatarId=10232","48x48":"http://jira.codehaus.org/secure/useravatar?avatarId=10232"},"displayName":"Olivier Lamy","active":true},"attachment":[],"customfield_10221":null,"customfield_10220":null,"customfield_10200":null,"aggregatetimeestimate":null,"customfield_10190":null,"project":{"self":"http://jira.codehaus.org/rest/api/2/project/11432","id":"11432","key":"PLXUTILS","name":"Plexus Utils","avatarUrls":{"16x16":"http://jira.codehaus.org/secure/projectavatar?size=xsmall&pid=11432&avatarId=10011","24x24":"http://jira.codehaus.org/secure/projectavatar?size=small&pid=11432&avatarId=10011","32x32":"http://jira.codehaus.org/secure/projectavatar?size=medium&pid=11432&avatarId=10011","48x48":"http://jira.codehaus.org/secure/projectavatar?pid=11432&avatarId=10011"},"projectCategory":{"self":"http://jira.codehaus.org/rest/api/2/projectCategory/10003","id":"10003","description":"various containers","name":"containers"}},"versions":[{"self":"http://jira.codehaus.org/rest/api/2/version/17516","id":"17516","description":"","name":"3.0","archived":false,"released":true,"releaseDate":"2011-06-23"}],"customfield_10170":[{"self":"http://jira.codehaus.org/rest/api/2/customFieldOption/10070","value":"Yes","id":"10070"}],"environment":"java version \"1.6.0_06\"\r\nJava(TM) SE Runtime Environment (build 1.6.0_06-b02)\r\nJava HotSpot(TM) 64-Bit Server VM (build 10.0-b22, mixed mode)\r\n","timeestimate":null,"customfield_10130":null,"aggregateprogress":{"progress":0,"total":0},"lastViewed":null,"components":[],"comment":{"startAt":0,"maxResults":4,"total":4,"comments":[{"self":"http://jira.codehaus.org/rest/api/2/issue/137589/comment/300451","id":"300451","author":{"self":"http://jira.codehaus.org/rest/api/2/user?username=olamy","name":"olamy","emailAddress":"olamy@apache.org","avatarUrls":{"16x16":"http://jira.codehaus.org/secure/useravatar?size=xsmall&avatarId=10232","24x24":"http://jira.codehaus.org/secure/useravatar?size=small&avatarId=10232","32x32":"http://jira.codehaus.org/secure/useravatar?size=medium&avatarId=10232","48x48":"http://jira.codehaus.org/secure/useravatar?avatarId=10232"},"displayName":"Olivier Lamy","active":true},"body":"note sources are now hosted here: github.com/sonatype/plexus-utils\r\nSo you can play with a pull request","updateAuthor":{"self":"http://jira.codehaus.org/rest/api/2/user?username=olamy","name":"olamy","emailAddress":"olamy@apache.org","avatarUrls":{"16x16":"http://jira.codehaus.org/secure/useravatar?size=xsmall&avatarId=10232","24x24":"http://jira.codehaus.org/secure/useravatar?size=small&avatarId=10232","32x32":"http://jira.codehaus.org/secure/useravatar?size=medium&avatarId=10232","48x48":"http://jira.codehaus.org/secure/useravatar?avatarId=10232"},"displayName":"Olivier Lamy","active":true},"created":"2012-06-05T17:33:49.636-0500","updated":"2012-06-05T17:33:49.636-0500"},{"self":"http://jira.codehaus.org/rest/api/2/issue/137589/comment/300452","id":"300452","author":{"self":"http://jira.codehaus.org/rest/api/2/user?username=minfrin","name":"minfrin","emailAddress":"minfrin@sharp.fm","avatarUrls":{"16x16":"http://jira.codehaus.org/secure/useravatar?size=xsmall&avatarId=10232","24x24":"http://jira.codehaus.org/secure/useravatar?size=small&avatarId=10232","32x32":"http://jira.codehaus.org/secure/useravatar?size=medium&avatarId=10232","48x48":"http://jira.codehaus.org/secure/useravatar?avatarId=10232"},"displayName":"Graham Leggett","active":true},"body":"The patch applied cleanly to the git clone that I created and all tests still passed. I need to reread the git docs yet again to figure out how pull requests work, sigh.","updateAuthor":{"self":"http://jira.codehaus.org/rest/api/2/user?username=minfrin","name":"minfrin","emailAddress":"minfrin@sharp.fm","avatarUrls":{"16x16":"http://jira.codehaus.org/secure/useravatar?size=xsmall&avatarId=10232","24x24":"http://jira.codehaus.org/secure/useravatar?size=small&avatarId=10232","32x32":"http://jira.codehaus.org/secure/useravatar?size=medium&avatarId=10232","48x48":"http://jira.codehaus.org/secure/useravatar?avatarId=10232"},"displayName":"Graham Leggett","active":true},"created":"2012-06-05T17:40:51.222-0500","updated":"2012-06-05T17:40:51.222-0500"},{"self":"http://jira.codehaus.org/rest/api/2/issue/137589/comment/300454","id":"300454","author":{"self":"http://jira.codehaus.org/rest/api/2/user?username=olamy","name":"olamy","emailAddress":"olamy@apache.org","avatarUrls":{"16x16":"http://jira.codehaus.org/secure/useravatar?size=xsmall&avatarId=10232","24x24":"http://jira.codehaus.org/secure/useravatar?size=small&avatarId=10232","32x32":"http://jira.codehaus.org/secure/useravatar?size=medium&avatarId=10232","48x48":"http://jira.codehaus.org/secure/useravatar?avatarId=10232"},"displayName":"Olivier Lamy","active":true},"body":"ok NP I will use that.\r\nBut take a look on how fork a project :P","updateAuthor":{"self":"http://jira.codehaus.org/rest/api/2/user?username=olamy","name":"olamy","emailAddress":"olamy@apache.org","avatarUrls":{"16x16":"http://jira.codehaus.org/secure/useravatar?size=xsmall&avatarId=10232","24x24":"http://jira.codehaus.org/secure/useravatar?size=small&avatarId=10232","32x32":"http://jira.codehaus.org/secure/useravatar?size=medium&avatarId=10232","48x48":"http://jira.codehaus.org/secure/useravatar?avatarId=10232"},"displayName":"Olivier Lamy","active":true},"created":"2012-06-05T17:49:49.468-0500","updated":"2012-06-05T17:49:49.468-0500"},{"self":"http://jira.codehaus.org/rest/api/2/issue/137589/comment/300456","id":"300456","author":{"self":"http://jira.codehaus.org/rest/api/2/user?username=olamy","name":"olamy","emailAddress":"olamy@apache.org","avatarUrls":{"16x16":"http://jira.codehaus.org/secure/useravatar?size=xsmall&avatarId=10232","24x24":"http://jira.codehaus.org/secure/useravatar?size=small&avatarId=10232","32x32":"http://jira.codehaus.org/secure/useravatar?size=medium&avatarId=10232","48x48":"http://jira.codehaus.org/secure/useravatar?avatarId=10232"},"displayName":"Olivier Lamy","active":true},"body":"fixed https://github.com/sonatype/plexus-utils/commit/4305d47b13c97bfddbef11d684e882261a292e3a","updateAuthor":{"self":"http://jira.codehaus.org/rest/api/2/user?username=olamy","name":"olamy","emailAddress":"olamy@apache.org","avatarUrls":{"16x16":"http://jira.codehaus.org/secure/useravatar?size=xsmall&avatarId=10232","24x24":"http://jira.codehaus.org/secure/useravatar?size=small&avatarId=10232","32x32":"http://jira.codehaus.org/secure/useravatar?size=medium&avatarId=10232","48x48":"http://jira.codehaus.org/secure/useravatar?avatarId=10232"},"displayName":"Olivier Lamy","active":true},"created":"2012-06-05T17:56:20.825-0500","updated":"2012-06-05T17:56:20.825-0500"}]},"timeoriginalestimate":null,"aggregatetimespent":null}}